{
  "ANNOTATION": "Exemple annoté pour générer la fonction getActants() - Pattern simple sans maps complexes",
  
  "EXTRACTION_METADATA": {
    "template_id": 72,
    "fonction_name": "getActants",
    "raison_nom": "@type[1] = 'jdc:Actant' → Actant déjà au singulier → Pluraliser → getActants",
    "variable_result": "$actant",
    "pattern": "SIMPLE - Peu de ressources liées, principalement des IDs directs"
  },

  "@context": "https://tests.arcanes.ca/omk/api-context",
  "@id": "https://tests.arcanes.ca/omk/api/items/14436",
  "@type": [
    "o:Item",
    "jdc:Actant"
  ],
  "ANNOTATION_@type": "jdc:Actant → getActants",

  "o:id": 14436,
  "o:resource_template": {
    "@id": "https://tests.arcanes.ca/omk/api/resource_templates/72",
    "o:id": 72
  },
  "ANNOTATION_o:resource_template": "EXTRAIT ICI : template_id = 72",

  "thumbnail_display_urls": {
    "large": "https://tests.arcanes.ca/omk/files/large/756c16201036bc496dccca6f0c9629af4004c3a0.jpg",
    "medium": "https://tests.arcanes.ca/omk/files/medium/756c16201036bc496dccca6f0c9629af4004c3a0.jpg",
    "square": "https://tests.arcanes.ca/omk/files/square/756c16201036bc496dccca6f0c9629af4004c3a0.jpg"
  },
  "ANNOTATION_thumbnail_display_urls": "Présence → GÉNÉRER logoQuery (mais pas utilisé dans getActants car picture vient de property_id 1701)",

  "dcterms:title": [
    {
      "type": "literal",
      "property_id": 1,
      "property_label": "Title",
      "is_public": true,
      "@value": "Renée Bourassa"
    }
  ],
  "ANNOTATION_dcterms:title": [
    "property_id: 1",
    "type: literal",
    "NOTE: Dans getActants, le titre n'est pas stocké directement car on a firstName + lastName",
    "Mais on pourrait ajouter: case 1: $actant['name'] = $value['value']; break;"
  ],

  "foaf:firstName": [
    {
      "type": "literal",
      "property_id": 139,
      "property_label": "firstName",
      "is_public": true,
      "@value": "Renée"
    }
  ],
  "ANNOTATION_foaf:firstName": [
    "property_id: 139",
    "type: literal",
    "PHP: case 139: $actant['firstname'] = $value['value']; break;"
  ],

  "foaf:lastName": [
    {
      "type": "literal",
      "property_id": 140,
      "property_label": "lastName",
      "is_public": true,
      "@value": "Bourassa"
    }
  ],
  "ANNOTATION_foaf:lastName": [
    "property_id: 140",
    "type: literal",
    "PHP: case 140: $actant['lastname'] = $value['value']; break;"
  ],

  "schema:url": [
    {
      "type": "uri",
      "property_id": 1517,
      "property_label": "url",
      "is_public": true,
      "@id": "https://www.design.ulaval.ca/personnel/professeurs/renee-bourassa"
    }
  ],
  "ANNOTATION_schema:url": [
    "property_id: 1517",
    "type: uri",
    "PHP: case 1517: $actant['url'] = $value['uri']; break;"
  ],

  "jdc:hasUniversity": [
    {
      "type": "resource",
      "property_id": 3038,
      "property_label": "A comme Université",
      "is_public": true,
      "@id": "https://tests.arcanes.ca/omk/api/items/14204",
      "value_resource_id": 14204,
      "value_resource_name": "items",
      "url": null,
      "display_title": "Université Laval",
      "thumbnail_url": "https://tests.arcanes.ca/omk/files/square/071d4d703696dbfcc65c09aa34d96d68af2c2f33.jpg",
      "thumbnail_title": "logo_min",
      "thumbnail_type": "image/png"
    }
  ],
  "ANNOTATION_jdc:hasUniversity": [
    "property_id: 3038",
    "type: resource",
    "PATTERN SIMPLE: Stocker uniquement l'ID, pas de map nécessaire",
    "Les détails seront récupérés via getUniversities() côté frontend",
    "PHP: case 3038: $actant['universities'][] = $value['value_resource_id']; break;"
  ],

  "jdc:hasEcoleDoctorale": [
    {
      "type": "resource",
      "property_id": 3043,
      "property_label": "A comme Ecole Doctorale",
      "is_public": true,
      "@id": "https://tests.arcanes.ca/omk/api/items/14247",
      "value_resource_id": 14247,
      "value_resource_name": "items",
      "url": null,
      "display_title": "École de design"
    }
  ],
  "ANNOTATION_jdc:hasEcoleDoctorale": [
    "property_id: 3043",
    "type: resource",
    "PATTERN SIMPLE: Stocker uniquement l'ID",
    "PHP: case 3043: $actant['doctoralSchools'][] = $value['value_resource_id']; break;"
  ],

  "jdc:hasLaboratoire": [
    {
      "type": "resource",
      "property_id": 3044,
      "property_label": "A comme laboratoire",
      "is_public": true,
      "@id": "https://tests.arcanes.ca/omk/api/items/14227",
      "value_resource_id": 14227,
      "value_resource_name": "items",
      "url": null,
      "display_title": "Laboratoire des nouvelles technologies de l'image, du son et de la scène (LANTISS)",
      "thumbnail_url": "https://tests.arcanes.ca/omk/files/square/3ad4b2d009947dba8915410c7c2b039612d6bc5f.jpg",
      "thumbnail_title": "logo_min",
      "thumbnail_type": "image/png"
    }
  ],
  "ANNOTATION_jdc:hasLaboratoire": [
    "property_id: 3044",
    "type: resource",
    "PATTERN SIMPLE: Stocker uniquement l'ID",
    "PHP: case 3044: $actant['laboratories'][] = $value['value_resource_id']; break;"
  ],

  "schema:image": [
    {
      "type": "resource",
      "property_id": 1701,
      "property_label": "image",
      "is_public": true,
      "@id": "https://tests.arcanes.ca/omk/api/media/15592",
      "value_resource_id": 15592,
      "value_resource_name": "media",
      "url": null,
      "display_title": "renee_bourassa.jpg",
      "thumbnail_url": "https://tests.arcanes.ca/omk/files/square/756c16201036bc496dccca6f0c9629af4004c3a0.jpg",
      "thumbnail_title": "renee_bourassa.jpg",
      "thumbnail_type": "image/jpeg"
    }
  ],
  "ANNOTATION_schema:image": [
    "property_id: 1701",
    "CAS SPÉCIAL: Image principale",
    "Utiliser storage_id et extension directement (pas value_resource_id)",
    "Les infos viennent du LEFT JOIN sur media dans valueQuery",
    "PHP: case 1701: if ($value['storage_id'] && $value['extension']) { $actant['picture'] = $this->generateThumbnailUrl($value['storage_id'], $value['extension']); } break;"
  ],

  "schema:email": [
    {
      "type": "literal",
      "property_id": 724,
      "property_label": "email",
      "is_public": true,
      "@value": "renee.bourassa@design.ulaval.ca"
    }
  ],
  "ANNOTATION_schema:email": [
    "property_id: 724",
    "type: literal",
    "PHP: case 724: $actant['mail'] = $value['value']; break;"
  ],

  "LISTE_COMPLETE_PROPERTY_IDS": [139, 140, 1517, 3038, 3043, 3044, 1701, 724],

  "PROPERTY_IDS_FINAUX_POUR_REQUETE": "139, 140, 1517, 1701, 3038, 3043, 3044, 724",

  "STRUCTURE_TABLEAU_INITIAL": {
    "ANNOTATION": "Structure simple, tous les champs initialisés à vide ou tableau vide",
    "id": "resource_id",
    "firstname": "''",
    "lastname": "''",
    "picture": "''",
    "mail": "''",
    "url": "''",
    "universities": "[]",
    "doctoralSchools": "[]",
    "laboratories": "[]"
  },

  "MAPS_A_GENERER": [
    "AUCUNE map complexe nécessaire !",
    "Toutes les propriétés de type resource sont stockées comme IDs simples",
    "La seule propriété spéciale est 1701 (image) qui utilise storage_id directement"
  ],

  "REQUETES_SQL": {
    "resourceQuery": {
      "description": "Récupération des IDs des actants",
      "sql": "SELECT r.id FROM `resource` r WHERE r.resource_template_id = 72 ORDER BY RAND()",
      "note": "ORDER BY RAND() pour randomiser l'ordre"
    },
    "valueQuery": {
      "description": "Récupération de toutes les propriétés avec LEFT JOIN sur media",
      "sql": "SELECT v.resource_id, v.value, v.property_id, v.value_resource_id, v.uri, v.type, m.id as media_id, m.storage_id, m.extension FROM `value` v LEFT JOIN `media` m ON v.value_resource_id = m.id WHERE v.resource_id IN (...) AND v.property_id IN (139, 140, 1517, 1701, 3038, 3043, 3044, 724)",
      "note": "LEFT JOIN nécessaire pour récupérer storage_id et extension pour property_id 1701"
    }
  },

  "SWITCH_CASE_COMPLET": {
    "case_139": "firstname = value",
    "case_140": "lastname = value",
    "case_1517": "url = uri",
    "case_724": "mail = value",
    "case_1701": "picture = generateThumbnailUrl(storage_id, extension) - CAS SPÉCIAL",
    "case_3038": "universities[] = value_resource_id",
    "case_3043": "doctoralSchools[] = value_resource_id",
    "case_3044": "laboratories[] = value_resource_id"
  },

  "COMPARAISON_AVEC_OEUVRES": {
    "Oeuvres": "Pattern COMPLEXE - Nombreuses maps pour ressources liées détaillées",
    "Actants": "Pattern SIMPLE - IDs directs, une seule propriété spéciale (1701)",
    "Conseil": "Utiliser le pattern Actants pour les templates simples, Oeuvres pour les complexes"
  },

  "CODE_PHP_RESUME": "function getActants() {\n  // 1. Requête principale (template 72)\n  // 2. Requête valeurs avec LEFT JOIN media\n  // 3. PAS de maps complexes\n  // 4. Boucle avec switch/case simple\n  // 5. Return result\n}"
}

